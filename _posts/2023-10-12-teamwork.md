---
toc: false
comments: true
layout: post
title: Teamwork
description: A jumping platformer by the Teamwork team!
type: hacks
courses: { compsci: {week: 7} }
---

<!DOCTYPE html>
<html>
<head>
    <title>Teamwork!</title>
</head>
<body>
    <canvas id="canvas" width="500" height="700"></canvas>
    <script>
        let canvas = document.getElementById("canvas");
        let c = canvas.getContext("2d");

        var spriteImage = new Image();
        spriteImage.src = "{{site.baseurl}}/images/linksprites.png";

        const spriteWidth = 96;
        const spriteHeight = 104;
        let spriteX = 100;
        let spriteY = canvas.height - spriteHeight;
        let spriteVelocityY = 0;
        let isJumping = false;
        let frameX = 0;
        let frameY = 0;
        let maxFrame = 2;
        let isMovingLeft = false;
        let isMovingRight = false;
        let isIdle = true;

        const gravity = 0.5;
        const jumpStrength = -10;
        const moveSpeed = 8; // Increase sprite movement speed

        function updateSpriteAnimation() {
            if (frameX < maxFrame) {
                frameX++;
            } else {
                frameX = 0;
            }
        }

        function jump() {
            if (!isJumping) {
                spriteVelocityY = jumpStrength;
                isJumping = true;
            }
        }

        function moveLeft() {
            isMovingLeft = true;
            isIdle = false;
            frameY = 5;
            maxFrame = 9;
        }

        function moveRight() {
            isMovingRight = true;
            isIdle = false;
            frameY = 7;
            maxFrame = 9;
        }

        function idle() {
            isIdle = true;
            frameY = 0;
            maxFrame = 2;
        }

        window.addEventListener('keydown', (event) => {
            if (event.key === 'w' && !isJumping) {
                jump();
            } else if (event.key === 'a') {
                moveLeft();
            } else if (event.key === 'd') {
                moveRight();
            }
        });

        window.addEventListener('keyup', (event) => {
            if (event.key === 'a') {
                idle();
                isMovingLeft = false;
            } else if (event.key === 'd') {
                idle();
                isMovingRight = false;
            }
        });

        // Load background image
        var bgImage = new Image();
        bgImage.src = "{{site.baseurl}}/images/Stone_Background.jpg";
        bgImage.onload = function () {
            // Set up backgrounds
            var bg1 = {
                width: 500,
                height: 1000,
                x: 0,
                y: 0
            }

            var bg2 = {
                width: 500,
                height: 1000,
                x: 0,
                y: -1000
            }

            var bg3 = {
                width: 500,
                height: 1000,
                x: 0,
                y: -2000
            }

            // Create an array to hold platform information
            var platforms = [];

            // Constants for jump behavior
            const jumpStrength = -10;

            // Function to generate random platforms throughout the screen
            function generateRandomPlatform() {
                // Define the platform properties
                var platform = {
                    width: 150,
                    height: 20,
                    x: Math.random() * (canvas.width - 150),
                    y: canvas.height - Math.random() * (canvas.height)  // Platforms appear at various vertical positions
                };
                platforms.push(platform);

                // Add a trampoline on some platforms randomly
                if (Math.random() < 0.1) { // Reduce the probability for fewer platforms
                    var trampoline = {
                        x: platform.x + platform.width / 2 - 10,
                        y: platform.y - 10,
                        width: 20,
                        height: 5,
                    };
                    platforms.push(trampoline);
                }
            }

            // Call the platform generation function initially to ensure a platform is within jumping distance
            generateRandomPlatform();

            // Call the platform generation function more slowly for fewer platforms
            setInterval(generateRandomPlatform, 1200); // Increase interval for fewer platforms

            // Main game loop
            var interval = setInterval(function () {
                // Move the backgrounds
                bg1.y += 5;
                bg2.y += 5;
                bg3.y += 5;

                if (bg1.y == 2000) {
                    bg1.y = 0;
                }
                if (bg2.y == 1000) {
                    bg2.y = -1000;
                }
                if (bg3.y == 0) {
                    bg3.y = -2000;
                }

                // Clear the canvas
                c.clearRect(0, 0, canvas.width, canvas.height);

                // Draw the background
                c.drawImage(bgImage, bg1.x, bg1.y);
                c.drawImage(bgImage, bg2.x, bg2.y);
                c.drawImage(bgImage, bg3.x, bg3.y);

                // Move and draw the platforms, including trampolines
                platforms.forEach(function (platform) {
                    if (platform.width === 20) {
                        // Draw a green line for the trampoline
                        c.strokeStyle = "cyan";
                        c.lineWidth = 5;
                        c.beginPath();
                        c.moveTo(platform.x, platform.y + 5);
                        c.lineTo(platform.x + platform.width, platform.y + 5);
                        c.stroke();
                    } else {
                        // Draw a yellow platform
                        c.fillStyle = "yellow";
                        c.fillRect(platform.x, platform.y, platform.width, platform.height);
                    }
                    platform.y += 5;
                });

                // Apply gravity and handle jumping
                spriteVelocityY += gravity;
                spriteY += spriteVelocityY;

                if (spriteY >= canvas.height - spriteHeight) {
                    spriteY = canvas.height - spriteHeight;
                    spriteVelocityY = 0;
                    isJumping = false;
                }

                // Handle sprite movement
                if (isMovingLeft && spriteX > 0) {
                    spriteX -= moveSpeed;
                }
                if (isMovingRight && spriteX + spriteWidth < canvas.width) {
                    spriteX += moveSpeed;
                }

                // Draw the sprite
                c.drawImage(
                    spriteImage,
                    frameX * spriteWidth,
                    frameY * spriteHeight,
                    spriteWidth,
                    spriteHeight,
                    spriteX,
                    spriteY,
                    spriteWidth,
                    spriteHeight
                );

                updateSpriteAnimation();
            }, 90);
        };
    </script>
</body>
</html>
